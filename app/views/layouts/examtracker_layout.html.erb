<!DOCTYPE html>
<html>
    <head>
        <title>Exam Tracker</title>
        <%= yield(:head_stylesheet) %>
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
              <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
              <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
            <![endif]-->

        <%-#= stylesheet_link_tag    'bootstrap.min', 'data-turbolinks-track' => true -%>
        <%= stylesheet_link_tag    'bootstrap.min', 'data-turbolinks-track' => false %>
        <%= stylesheet_link_tag    'font-awesome.min', 'data-turbolinks-track' => false %>
        <%= stylesheet_link_tag    'datatables/dataTables.bootstrap', 'data-turbolinks-track' => false %>
        <%= stylesheet_link_tag    'AdminLTE', 'data-turbolinks-track' => false %>

        <% javascriptHead 'jquery.min' %>
        <%= yield(:head_javascript) %>
        <%= yield :head_javascript_section %>

<%#= stylesheet_link_tag    "application", :media => "all" %>
<%#= javascript_include_tag "application" %>
        <%= csrf_meta_tags %>
        <%= harbingerjs_setup %>
        <%= yield(:javascript_includes) %>
        <%= @web_analytics_tracker.html_safe %>

    </head>
    <body class="skin-blue">
        <!-- Start Navbar -->
        <!--div id="primary-navbar" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <a class="navbar-brand" id="app-name" href="<%= root_url %>">Vanilla Application</a-->

        <!-- Brand and toggle get grouped for better mobile display -->
        <!--div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
          </div>
          <div class="collapse navbar-collapse" id="navbar-collapse">
            <ul class="nav navbar-nav pull-right">
              <li><%= global_navigation_link "About", :controller => :main,  :action => :about %></li>
              <li><%= global_navigation_link "Help", :controller => :main,  :action => :help %></li>
        <% any_authorized(["ai-staff", "it-staff"]) do %>
                    <li><%= global_navigation_link "Admin", :controller => :admin, :action => :index %></li>
        <% end %>
              <li><a href="<%= root_url %>/home/logout">Logout</a></li>
            </ul>
          </div>
        </div>
      </div-->

        <header class="header">
            <a href="#" class="logo">
                <!-- Add the class icon to your logo image or logo icon to add the margining -->
                Exam Tracker </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top" role="navigation">
                <!-- Sidebar toggle button-->
                <a href="#" class="navbar-btn sidebar-toggle" data-toggle="offcanvas" role="button"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a>
                <div class="navbar-right">
                    <ul class="nav navbar-nav">
                        <li class="user user-menu"><a href="<%= root_url %>" class="dropdown-toggle" data-toggle=""><span>Home</span> </a></li>
                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><span>Reports <i class="caret"></i></span></a>
                            <ul class="dropdown-menu" style="width: 150px;">

                                <!-- Menu Body -->
                                <li class="user-body">
                                    <div class="col-xs-12 text-center"><a href="#">Sub item 1</a> </div>
                                    <div class="col-xs-12 text-center"><a href="#">Sub item 2</a> </div>
                                    <div class="col-xs-12 text-center"><a href="#">Sub item 3</a> </div>
                                </li>
                            </ul>
                        </li>
                        <li class="dropdown user user-menu"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><span>Admin <i class="caret"></i></span></a>
                            <ul class="dropdown-menu" style="width: 150px;">

                                <!-- Menu Body -->
                                <li class="user-body">
                                    <div class="col-xs-12 text-center"><a href="#">Sub item 1</a> </div>
                                    <div class="col-xs-12 text-center"><a href="#">Sub item 2</a> </div>
                                    <div class="col-xs-12 text-center"><a href="#">Sub item 3</a> </div>
                                </li>
                            </ul>
                        </li>
                        <li class="user user-menu"><a href="<%= root_url %>/home/logout" class="dropdown-toggle" data-toggle=""><span>Logout</span> </a></li>
                    </ul>
                </div>
            </nav>
        </header>

        <div class="wrapper row-offcanvas row-offcanvas-left">
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="left-side sidebar-offcanvas">
                <!-- sidebar: style can be found in sidebar.less -->
                <section class="sidebar">
                    <!-- Sidebar user panel -->
                    <div class="user-panel">
                        <div class="pull-left image">
                            <img src="/assets/avatar5.png" class="img-circle" alt="User Image" />
                        </div>
                        <div class="pull-left info">
                            <p>Hello, <%= @employee.name %>(<%= @employee.id.to_s %>)   </p>

                            <a href="#"><i class="fa fa-circle text-success"></i>Online</a>
                        </div>
                    </div>
                    <!-- search form -->
                    <!--<form action="#" method="get" class="sidebar-form">
            <div class="input-group">
              <input type="text" name="q" class="form-control" placeholder="Search..."/>
              <span class="input-group-btn">
              <button type='submit' name='seach' id='search-btn' class="btn btn-flat"><i class="fa fa-search"></i></button>
              </span> </div>
          </form>-->
                    <!-- /.search form -->
                    <!-- sidebar menu: : style can be found in sidebar.less -->
                    <ul class="sidebar-menu">
                        <li class="active">

                            <a href="radiologist"><i class="fa fa-comment"></i><span>Radiologist</span> </a></li>
                        <li><a href="technologist"><i class="fa fa-exclamation"></i><span>Technologist</span> </a></li>
                        <li><a href="scheregistrar"><i class="fa fa-file-text-o"></i><span>Sche-Registrar</span> </a></li>
                        <li><a href="transcript"><i class="fa fa-stethoscope"></i><span>Transcript</span> </a></li>
                        <li><a href="others"><i class="fa fa-medkit"></i><span>Others</span></a></li>
                        <li><a href="search"><i class="fa fa-eye"></i><span>Search</span></a></li>
                        <!--<li><a href="/home/experiment"><i class="fa fa-eye"></i><span>Experiment</span></a></li>
                        <li><a href="/home/jqgrid_page"><i class="fa fa-eye"></i><span>JQ Grid Page</span></a></li>
                        <li><a href="/sessions/get_sessions"><i class="fa fa-eye"></i><span style="color:orangered">Sessions</span></a></li>
                        <li> <a href="index.html"> <i class="fa fa-dashboard"></i> <span>Dashboard</span> </a> </li>
                        <li> <a href="../widgets.html"> <i class="fa fa-th"></i> <span>Widgets</span> <small class="badge pull-right bg-green">new</small> </a> </li>
                        <li class="treeview"> <a href="#"> <i class="fa fa-bar-chart-o"></i> <span>Charts</span> <i class="fa fa-angle-left pull-right"></i> </a>
                        <ul class="treeview-menu">
                      <li><a href="../charts/morris.html"><i class="fa fa-angle-double-right"></i> Morris</a></li>
                        <li><a href="../charts/flot.html"><i class="fa fa-angle-double-right"></i> Flot</a></li>
                      <li><a href="../charts/inline.html"><i class="fa fa-angle-double-right"></i> Inline charts</a></li>
                      </ul>
                  </li>
            <li class="treeview"> <a href="#"> <i class="fa fa-laptop"></i> <span>UI Elements</span> <i class="fa fa-angle-left pull-right"></i> </a>
              <ul class="treeview-menu">
                <li><a href="../UI/general.html"><i class="fa fa-angle-double-right"></i> General</a></li>
                <li><a href="../UI/icons.html"><i class="fa fa-angle-double-right"></i> Icons</a></li>
                <li><a href="../UI/buttons.html"><i class="fa fa-angle-double-right"></i> Buttons</a></li>
                <li><a href="../UI/sliders.html"><i class="fa fa-angle-double-right"></i> Sliders</a></li>
                <li><a href="../UI/timeline.html"><i class="fa fa-angle-double-right"></i> Timeline</a></li>
              </ul>
            </li>
            <li class="treeview"> <a href="#"> <i class="fa fa-edit"></i> <span>Forms</span> <i class="fa fa-angle-left pull-right"></i> </a>
              <ul class="treeview-menu">
                <li><a href="../forms/general.html"><i class="fa fa-angle-double-right"></i> General Elements</a></li>
                <li><a href="../forms/advanced.html"><i class="fa fa-angle-double-right"></i> Advanced Elements</a></li>
                <li><a href="../forms/editors.html"><i class="fa fa-angle-double-right"></i> Editors</a></li>
              </ul>
            </li>
            <li class="treeview active"> <a href="#"> <i class="fa fa-table"></i> <span>Tables</span> <i class="fa fa-angle-left pull-right"></i> </a>
              <ul class="treeview-menu">
                <li><a href="simple.html"><i class="fa fa-angle-double-right"></i> Simple tables</a></li>
                <li class="active"><a href="data.html"><i class="fa fa-angle-double-right"></i> Data tables</a></li>
              </ul>
            </li>
            <li> <a href="../calendar.html"> <i class="fa fa-calendar"></i> <span>Calendar</span> <small class="badge pull-right bg-red">3</small> </a> </li>
            <li> <a href="../mailbox.html"> <i class="fa fa-envelope"></i> <span>Mailbox</span> <small class="badge pull-right bg-yellow">12</small> </a> </li>
            <li class="treeview"> <a href="#"> <i class="fa fa-folder"></i> <span>Examples</span> <i class="fa fa-angle-left pull-right"></i> </a>
              <ul class="treeview-menu">
                <li><a href="../examples/invoice.html"><i class="fa fa-angle-double-right"></i> Invoice</a></li>
                <li><a href="../examples/login.html"><i class="fa fa-angle-double-right"></i> Login</a></li>
                <li><a href="../examples/register.html"><i class="fa fa-angle-double-right"></i> Register</a></li>
                <li><a href="../examples/lockscreen.html"><i class="fa fa-angle-double-right"></i> Lockscreen</a></li>
                <li><a href="../examples/404.html"><i class="fa fa-angle-double-right"></i> 404 Error</a></li>
                <li><a href="../examples/500.html"><i class="fa fa-angle-double-right"></i> 500 Error</a></li>
                <li><a href="../examples/blank.html"><i class="fa fa-angle-double-right"></i> Blank Page</a></li>
              </ul>
            </li>-->
                    </ul>
                </section>
                <!-- /.sidebar -->
            </aside>

            <!--aside class="right-side" This line will come from pages who use this layout-->
            <%= yield %>             
        </aside>
    </div>

    <!-- popp modal start -->
    <div class="modal fade" id="ExamDetailPopupDiv" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">

                    <button aria-hidden="true" data-dismiss="modal" class="close" type="button">X</button>
                    <h4 id="lblPopupTitle" class="modal-title clrwhite">Exam Details</h4>
                    <!-- color changed-->
                </div>
                <div class="modal-body">
                    <div class="loadingModal" id="resultLoadingview" role="dialog" data-backdrop="static" data-keyboard="false">
                        <div class='centered' style='width: 250px; height: 65px; text-align: center;'>
                            <div class='circularDivContainer centered'>
                                <div class='circularDiv circularDiv_1'></div>
                                <div class='circularDiv circularDiv_2'></div>
                                <div class='circularDiv circularDiv_3'></div>
                                <div class='circularDiv circularDiv_4'></div>
                                <div class='circularDiv circularDiv_5'></div>
                                <div class='circularDiv circularDiv_6'></div>
                                <div class='circularDiv circularDiv_7'></div>
                                <div class='circularDiv circularDiv_8'></div>
                            </div>
                            <br />
                            <p style='color: black; width: 250px;'><b>Please wait while we process your request...</b></p>
                        </div>
                    </div>

                    <div>
                        <section class="content">
                            <div class="row">
                                <div class="col-md-6">
                                    <!-- general form elements disabled -->
                                    <!--<h1>Exam Details</h1>-->
                                    <h3 id="currentStatusH3" style="color: green; text-transform: uppercase;"></h3>
                                    <div id="divstatus">
                                        <div class="wizard">
                                            <a class="grey"><span class="badge"></span></a>
                                            <a class="grey"><span class="badge"></span></a>
                                            <a class="grey"><span class="badge"></span></a>
                                            <a class="grey"><span class="badge"></span></a>
                                            <a class="grey"><span class="badge badge-inverse"></span></a>
                                            <a class="grey"><span class="badge"></span></a>
                                        </div>
                                    </div>

                                    <!-- /.box -->
                                    <!--h3><font color="purple">Delivered</font></h3-->
                                    <h4><font color="purple"><span id="lblRadiologist"></span></font></h4>
                                    <div>

                                        <table border="0" cellpadding="0" cellspacing="0" width="489" style='border-collapse: collapse; table-layout: fixed; width: 367pt'>
                                            <col width="193" style='mso-width-source: userset; mso-width-alt: 7058; width: 145pt'>
                                            <col width="196" style='mso-width-source: userset; mso-width-alt: 7168; width: 147pt'>
                                            <col width="100" style='mso-width-source: userset; mso-width-alt: 3657; width: 75pt'>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" width="193" style='height: 15.75pt; width: 145pt'>&nbsp;</td>
                                                <td class="xl66" width="196" style='border-left: none; width: 147pt'>&nbsp;</td>
                                                <td class="xl67" width="100" style='border-left: none; width: 75pt'>Type</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>Exam
                                                    Information</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Procedure</td>
                                                <td id="lblProcedure" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Patient type class</td>
                                                <td id="lblpatient_class" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Trauma Emg</td>
                                                <td id="lbltrauma" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Resource</td>
                                                <td id="lblresource" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Modality</td>
                                                <td id="lblmodality" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>Staff</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Techno</td>
                                                <td id="lbltechnologist" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Finalizing Radiologist</td>
                                                <td id="lblfinalRadiologist" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>Time</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Order</td>
                                                <td id="lblorder" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>

                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Appointment</td>
                                                <td id="lblappt_time" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Sign In</td>
                                                <td id="lblsign_in" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Begin Exam</td>
                                                <td id="lblbegin_exam" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>End Exam</td>
                                                <td id="lblend_exam" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>First Final</td>
                                                <td id="lblfirst_final" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Last Final</td>
                                                <td id="lbllast_final" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>Metrics</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Sche Event to app
                                                    time</td>
                                                <td id="lblscheEventToappt" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Appt to Begin</td>
                                                <td id="lblwaitduration" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Total patient Wait</td>
                                                <td id="lbltotalpatientwait" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Exam Duration</td>
                                                <td id="lbleduration" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Final Turnaround Time</td>
                                                <td id="lblfinalTurnaroundTime" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>Indentifiers</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>&nbsp;</td>
                                            </tr>
                                            <tr height="21" style='height: 15.75pt'>
                                                <td height="21" class="xl65" style='height: 15.75pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>Accession#</td>
                                                <td id="lblaccession" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <tr height="20" style='height: 15.0pt'>
                                                <td height="20" class="xl66" style='height: 15.0pt; border-top: none'>&nbsp;</td>
                                                <td class="xl66" style='border-top: none; border-left: none'>MRN(AI:MWebWare Hospital)</td>
                                                <td id="lblmrn" class="xl66" style='border-top: none; border-left: none'>label</td>
                                            </tr>
                                            <![if supportMisalignedColumns]>
                                            <tr height="0" style='display: none'>
                                                <td width="193" style='width: 145pt'></td>
                                                <td width="196" style='width: 147pt'></td>
                                                <td width="100" style='width: 75pt'></td>
                                            </tr>
                                            <![endif]>
                                        </table>
                                    </div>

                                </div>

                                <div class="col-md-6">
                                    <!-- general form elements disabled -->
                                    <h2>Report History</h2>
                                    <div id="reportHistoryContainerDiv">
                                    </div>
                                    <!-- /.box -->
                                </div>

                            </div>
                            <!-- /.row -->
                        </section>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="Btns BtnClose pull-right" id="" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- popp modal End -->

    <!--div class="container">
<%#= yield %>
  </div-->

    <%= yield(:body_javascript) %>
    <%= yield :body_javascript_section %>
    <script type='text/javascript'>

      (function () {

          function DateDiff(date1, date2) {
              this.days = null;
              this.hours = null;
              this.minutes = null;
              this.seconds = null;
              this.date1 = date1;
              this.date2 = date2;

              this.init();
          }

          DateDiff.prototype.init = function () {
              var data = new DateMeasure(this.date1 - this.date2);
              this.days = data.days;
              this.hours = data.hours;
              this.minutes = data.minutes;
              this.seconds = data.seconds;
          };

          function DateMeasure(ms) {
              var d, h, m, s;
              s = Math.floor(ms / 1000);
              m = Math.floor(s / 60);
              s = s % 60;
              h = Math.floor(m / 60);
              m = m % 60;
              d = Math.floor(h / 24);
              h = h % 24;

              this.days = d;
              this.hours = h;
              this.minutes = m;
              this.seconds = s;
          }
          ;

          Date.diff = function (date1, date2) {
              return new DateDiff(date1, date2);
          };

          Date.prototype.diff = function (date2) {
              return new DateDiff(this, date2);
          };

      })();

      function showExamDetail(id) {

          $("#divstatus").html('<div class=wizard"><a class="grey"><span class="badge"></span></a><a class="grey"><span class="badge"></span></a><a class="grey"><span class="badge"></span></a><a class="grey"><span class="badge"></span></a><a class="grey"><span class="badge badge-inverse"></span></a><a class="grey"><span class="badge"></span></a></div>')
          $("#ExamDetailPopupDiv").modal('show');
          $("#resultLoadingview").modal('show');

          //debugger;
          id = id.replace("lnk$#", "");
          var myobj;
          $.ajax({
              url: '/home/get_accession',
              type: 'POST',
              dataType: 'json',
              //contentType: "application/json; charset=utf-8",
              data: {
                  accession_id: id,
                  authenticity_token: window._token
              },
              success: function (resultExamDetail) {
                  $("#resultLoadingview").modal('hide');

                  try {
                      mydata = JSON.stringify(resultExamDetail);
                      // alert(mydata);
                      myobj = JSON.parse(mydata);

                      // start processing data from here into a function if possible
                      $.ajax({
                          url: '/home/get_accession_report',
                          type: 'POST',
                          dataType: 'json',
                          //contentType: "application/json; charset=utf-8",
                          data: {
                              accession_id: id,
                              authenticity_token: window._token
                          },
                          success: function (resultReportHistories) {

                              $("#reportHistoryContainerDiv").empty();
                              $(resultReportHistories).each(function (index, resultReportHistory) {
                                  if ((resultReportHistory.status != null) && (resultReportHistory.status != '')) {
                                      $("#reportHistoryContainerDiv").append('<div> <h3>' + resultReportHistory.report_impression + '</h3> <b>status:</b>' + resultReportHistory.status + '<br> <b>Time:</b>' + format_date_time(resultReportHistory.report_time) + '<br> <b>Radiologist:</b>' + resultReportHistory.rad1_name + '<br> <b>Radiologist:</b>' + resultReportHistory.rad2_name + '<br> </br></br></br> <p>' + resultReportHistory.report_body + '</p> </div>');
                                  }
                              });
                              if ($("#reportHistoryContainerDiv").text() == "") {
                                  $("#reportHistoryContainerDiv").append('<div> <h4 style="color:red" >No Report found.</h4></div>');
                              }

                              $("#currentStatusH3").text(myobj.current_status);
                          },
                          error: function (resultReportHistories) {
                              debugger;
                          }
                      });

                      //exam information

                      $("#lblProcedure").text(myobj.description + "(" + myobj.code + ")");
                      $("#lblpatient_class").text(NullEmpty(myobj.patient_type) + "-" + NullEmpty(myobj.patient_class));
                      $("#lbltrauma").text(NullEmpty(myobj.trauma));
                      $("#lblmodality").text(NullEmpty(myobj.modality));
                      $("#lblresource").text(NullEmpty(myobj.resource_name));

                      //staff parts
                      $("#lbltechnologist").text(NullEmpty(myobj.technologist));

                      if ((myobj.rad1_name != null) && (myobj.rad1_name != '')) {
                          $("#lblRadiologist").text("Signed by: " + myobj.rad1_name);
                          $("#lblfinalRadiologist").text(myobj.rad1_name);
                      }

                      $("#lblfinalRadiologist").text(NullEmpty(myobj.rad2_name));

                      //time parts
                      $("#lblorder").text(format_date_time(myobj.order_arrival));
                      $("#lblappt_time").text(format_date_time(myobj.appt_time));
                      $("#lblsign_in").text(TimeFromDateTime(myobj.sign_in));
                      $("#lblbegin_exam").text(TimeFromDateTime(myobj.begin_exam));
                      $("#lblend_exam").text(TimeFromDateTime(myobj.end_exam));
                      $("#lblfirst_final").text(TimeFromDateTime(myobj.first_final));
                      $("#lbllast_final").text(TimeFromDateTime(myobj.last_final));
                      var scheventime = new Date(myobj.order_arrival);
                      var aptime = new Date(myobj.appt_time);

                      var btime = new Date(myobj.begin_exam);
                      var etime = new Date(myobj.end_exam);
                      var eduration = new Date(etime - btime);
                      var waitduarion = new Date(btime - aptime);
                      var sched_to_aptime = new Date(aptime - scheventime);
                      var finalTurnaroundTime = new Date(etime - scheventime);
                      var totalpatientwait = new Date(btime - scheventime);

                      $("#lbleduration").text(eduration.toISOString().substr(11, 8));
                      $("#lblwaitduration").text(waitduarion.toISOString().substr(11, 8));
                      $("#lblscheEventToappt").text(DaysTimeWait(sched_to_aptime.toISOString()));
                      $("#lbltotalpatientwait").text(DaysTimeWait(totalpatientwait.toISOString()));
                      $("#lblfinalTurnaroundTime").text(DaysTimeWait(finalTurnaroundTime.toISOString()));




                      //indentifiers
                      $("#lblaccession").text(myobj.accession);
                      $("#lblmrn").text(NullEmpty(myobj.mrn));

                      var statusdiv = parseExamStatusGraph(myobj.graph_status);
                      $("#divstatus").html(statusdiv);

                      //$("#ExamDetailPopupDiv").modal('show');

                  }
                  catch (err) {
                      alert(err.message);
                  }

              },
              error: function (data) {
                  debugger;
              }
          });

      }

      function parseExamStatusGraph(cellvalue){         
            var cellvalue_array = cellvalue.split(',');
            //(cellvalue_array[0].split('->')[1] != "") ? cellvalue_array[0].split('->')[1] : cellvalue_array[1].split('->')[1];
            var firstStageTitle = cellvalue_array[0].split('->')[1]; //Order Stage
            var secondStageTitle = cellvalue_array[1].split('->')[1]; //Scheduled stage
            var thirdStageTitle = (cellvalue_array[3].split('->')[1] != "") ? cellvalue_array[3].split('->')[1] : cellvalue_array[4].split('->')[1]; //arrived stage
            var fourthStageTitle = cellvalue_array[5].split('->')[1]; //begin stage
            var fifthStageTitle = cellvalue_array[6].split('->')[1]; //complete or prelim stage
            var sixthStageTitle = cellvalue_array[7].split('->')[1]; //final stage

		if(cellvalue_array[cellvalue_array.length -1] == "order"){
			return '<div class="wizard"><a class="current" title='+ firstStageTitle +'><i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i><span class="badge"></span></a><a class="grey" title='+ secondStageTitle +'><span class="badge"></span></a><a class="grey" title='+ thirdStageTitle +'><span class="badge"></span></a><a class="grey" title='+ fourthStageTitle +'><span class="badge"></span></a><a class="grey" title='+ fifthStageTitle +'><span class="badge badge-inverse"></span></a><a title='+ sixthStageTitle +'><span class="badge"></span></a></div>';
		}
		else if(cellvalue_array[cellvalue_array.length -1]=="scheduled"){
			return '<div class="wizard"><a class="current" title='+ firstStageTitle +'><span class="badge"></span></a><a class="softcyanlimegreen" title='+ secondStageTitle +'><i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i><span class="badge"></span></a><a class="grey" title='+ thirdStageTitle +'><span class="badge"></span></a><a class="grey" title='+ fourthStageTitle +'><span class="badge"></span></a><a class="grey" title='+ fifthStageTitle +'><span class="badge badge-inverse"></span></a><a title='+ sixthStageTitle +'><span class="badge"></span></a></div>';
		}
		else if(cellvalue_array[cellvalue_array.length -1] == "arrived"){
			return '<div class="wizard"><a class="current" title='+ firstStageTitle +'><span class="badge"></span></a><a class="softcyanlimegreen" title='+ secondStageTitle +'><span class="badge"></span></a><a class="vanilla" title='+ thirdStageTitle +'><i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i><span class="badge"></span></a><a class="grey" title='+ fourthStageTitle +'><span class="badge"></span></a><a class="grey" title='+ fifthStageTitle +'><span class="badge badge-inverse"></span></a><a title='+ sixthStageTitle +'><span class="badge"></span></a></div>';
		}
		else if(cellvalue_array[cellvalue_array.length -1] == "begin"){
			return '<div class="wizard"><a class="current" title='+ firstStageTitle +'><span class="badge"></span></a><a class="softcyanlimegreen" title='+ secondStageTitle +'><span class="badge"></span></a><a class="vanilla" title='+ thirdStageTitle +'><span class="badge"></span></a><a class="violet" title='+ fourthStageTitle +'><i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i><span class="badge"></span></a><a class="grey" title='+ fifthStageTitle +'><span class="badge badge-inverse"></span></a><a title='+ sixthStageTitle +'><span class="badge"></span></a></div>';
		}
		else if(cellvalue_array[cellvalue_array.length-1] == "complete"){

			return '<div class="wizard"><a class="current" title='+ firstStageTitle +'><span class="badge"></span></a><a class="softcyanlimegreen" title='+ secondStageTitle +'><span class="badge"></span></a><a class="vanilla" title='+ thirdStageTitle +'><span class="badge"></span></a><a class="violet" title='+ fourthStageTitle +'><span class="badge"></span></a><a class="darkorange" title='+ fifthStageTitle +'><i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i><span class="badge badge-inverse"></span></a><a title='+ sixthStageTitle +'><span class="badge"></span></a></div>';
		}
                else if ( (cellvalue_array[cellvalue_array.length-1]=="dictated") || (cellvalue_array[cellvalue_array.length-1]=="prelim") || (cellvalue_array[cellvalue_array.length-1]=="corrections") ){
			return '<div class="wizard"><a class="current" title='+ firstStageTitle +'><span class="badge"></span></a><a class="softcyanlimegreen" title='+ secondStageTitle +'><span class="badge"></span></a><a class="vanilla" title='+ thirdStageTitle +'><span class="badge"></span></a><a class="violet" title='+ fourthStageTitle +'><span class="badge"></span></a><a class="darkorange" title='+ fifthStageTitle +'><span class="badge badge-inverse"></span></a><a class="gold" title='+ sixthStageTitle +'><i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i></a></div>';
		}
		else if ( (cellvalue_array[cellvalue_array.length-1]=="final") || (cellvalue_array[cellvalue_array.length-1]=="addendum") ){
			return '<div class="wizard"><a class="current" title='+ firstStageTitle +'><span class="badge"></span></a><a class="softcyanlimegreen" title='+ secondStageTitle +'><span class="badge"></span></a><a class="vanilla" title='+ thirdStageTitle +'><span class="badge"></span></a><a class="violet" title='+ fourthStageTitle +'><span class="badge"></span></a><a class="darkorange" title='+ fifthStageTitle +'><span class="badge badge-inverse"></span></a><a class="green" title='+ sixthStageTitle +'><i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i></a></div>';
		}
		else if(cellvalue_array[cellvalue_array.length-1]=="cancelled"){
			
			var cancelledAtStageClass = "sixthStageClass";
                        if(sixthStageTitle == ""){
                          cancelledAtStageClass = "fifthStageClass";
                          if(fifthStageTitle == ""){
                             cancelledAtStageClass = "fourthStageClass";
                             if(fourthStageTitle == ""){
                                cancelledAtStageClass = "thirdStageClass";
                                if(thirdStageTitle == ""){
                                  cancelledAtStageClass = "secondStageClass";
                                  if(secondStageTitle == ""){                                    
                                    cancelledAtStageClass = "firstStageClass";
                                  }
                                }
                             }
                          }
                        }
                        /*
			if(sixthStageTitle == ""){
				if(fifthStageTitle == ""){
					if(fourthStageTitle == ""){
						if(thirdStageTitle == ""){
							if(secondStageTitle == ""){
								cancelledAtStageClass = "firstStageClass";
							}
							else{
								cancelledAtStageClass = "secondStageClass";
							}
						}
						else{
							cancelledAtStageClass = "thirdStageClass";
						}
					}
					else{
						cancelledAtStageClass = "fourthStageClass";
					}
				}
				else{                                      
					cancelledAtStageClass = "fifthStageClass";                                       
				}
			}
			else{
				cancelledAtStageClass = "sixthStageClass";
			}
                        */
			//GraphUI to be displayed when cancelled status comes.
			var graphStatusUI = $('<div class="wizard"><a class="firstStageClass current" title='+ firstStageTitle +'><span class="badge"></span></a><a class="secondStageClass softcyanlimegreen" title='+ secondStageTitle +'><span class="badge"></span></a><a class="thirdStageClass vanilla" title='+ thirdStageTitle +'><span class="badge"></span></a><a class="fourthStageClass violet" title='+ fourthStageTitle +'><span class="badge"></span></a><a class="fifthStageClass darkorange" title='+ fifthStageTitle +'><span class="badge badge-inverse"></span></a><a class="sixthStageClass green" title='+ sixthStageTitle +'></a></div>');
			var cancelledStageIndex = $(graphStatusUI).find('a.'+ cancelledAtStageClass +'').index();
			//$(graphStatusUI).find('a:lt('+cancelledStageIndex+')').addClass("current");
			$(graphStatusUI).find('a:eq('+cancelledStageIndex+')').removeClass();
                        $(graphStatusUI).find('a:eq('+cancelledStageIndex+')').addClass("red").append('<i class="fa fa-check" style="display: table-cell; float: right; margin: 8px;"></i>');
                        $(graphStatusUI).find('a:gt('+cancelledStageIndex+')').removeClass();		
                        $(graphStatusUI).find('a:gt('+cancelledStageIndex+')').addClass("grey");			
			 return $(graphStatusUI).prop('outerHTML');
		}
		else{
			return 'Can not parse "' + cellvalue + '" status';
		}
	  }

      function TimeFromDateTime(mydate)
      {
          var datetext = '';
          if (mydate == null) {
              return datetext;
          }
          d = new Date(mydate);
          if (d != null) {
              datetext = d.toTimeString();
              datetext = datetext.split(' ')[0];
          }
          return datetext;
      }
      function DaysTimeWait(mydate) {
          var datetext = '';
          if (mydate == null) {
              return datetext;
          }
          d = new Date(mydate);
          if (d != null) {
              datetext = pad2(d.getDate()) + "d "
              datetext += pad2(d.getHours()) + ":"
              datetext += pad2(d.getMinutes()) + ":"
              datetext += pad2(d.getSeconds());
          }
          return datetext;
      }
      function pad2(n) {
          return n < 10 ? '0' + n : n;
      }

      function format_date_time(mydate) {
          var datetext = '';
          if (mydate == null) {
              return datetext;
          }
            d = new Date(mydate);
          if (d != null) {
              datetext = d.getFullYear() + "-"
              datetext += pad2(d.getMonth() + 1) + "-"
              datetext += pad2(d.getDate()) + " "
              datetext += pad2(d.getHours()) + ":"
              datetext += pad2(d.getMinutes()) + ":"
              datetext += pad2(d.getSeconds());
          }

          return datetext;
      }

      function NullEmpty(data)
      {
          if (data != null) {
              return data
          } else {
              return '';
          }

      }
      
      
      
	
function localizeDateStr (date_to_convert_str) {
  var date_to_convert = new Date(date_to_convert_str);
  var local_date = new Date(); 
  date_to_convert.setHours(date_to_convert.getHours()+local_date.getTimezoneOffset??()); 
  return date_to_convert.toString(); } 
    </script>
</body>
</html>
